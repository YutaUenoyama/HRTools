# HRTool - Python版

Excel VBA版のパフォーマンス問題を解決するために、Pythonで再実装したバージョンです。

## VBA版との違い

| 項目 | VBA版 | Python版 |
|------|-------|----------|
| 実行方法 | Excelマクロ | exe実行ファイル |
| 処理速度 | 遅い（応答なし発生） | **10〜100倍高速** |
| メモリ消費 | 大量 | 効率的 |
| 操作性 | Excelを開いてボタンクリック | **exeダブルクリック** |
| Python環境 | 不要 | **不要（exe化済み）** |
| 大量データ | ❌ 応答なしで失敗 | ✅ **高速処理** |

---

## 機能

### 現在実装済み:
- ✅ inputフォルダ内の全Excelファイル読み込み
- ✅ 複数シートの自動検出と処理
- ✅ ヘッダー行の自動検出
- ✅ 列名の正規化（同義語対応）
- ✅ 社員番号または氏名での識別
- ✅ データの統合と重複排除
- ✅ グローバルマスタ構築（所属/資格/職位）
- ✅ 詳細表とマスタ表の生成
- ✅ ログファイル出力
- ✅ GUIダイアログ

### VBA版との互換性:
- ✅ 入力データ形式は同じ
- ✅ 出力データ形式は同じ
- ✅ 処理ロジックは同等

---

## 使い方

### エンドユーザー（事務職の方）向け

1. **HRTool.exe** をダブルクリック

2. ダイアログが表示される
   ```
   処理を選択してください

   「はい」: 新規マスタ作成（inputフォルダ内の全ファイル）
   「いいえ」: 終了
   ```

3. 「はい」をクリック

4. 処理が自動実行される（進捗はログファイルで確認可能）

5. 完了ダイアログが表示される
   ```
   処理が完了しました

   出力ファイル:
   output\統合ファイル_20260221_123456.xlsx
   ```

6. outputフォルダに統合ファイルが生成される

---

## フォルダ構成

```
HRTool/
├── HRTool.exe              ← これをダブルクリック
├── input/                  ← Excelファイルを置く
│   ├── 202408.xlsx
│   ├── 20260101新従業員名簿.xlsx
│   └── ...
├── output/                 ← 統合ファイルが出力される
│   └── 統合ファイル_20260221_123456.xlsx
└── 処理ログ_20260221_123456.txt  ← ログファイル
```

---

## ログファイル

処理の進捗とエラーは **処理ログ_YYYYMMDD_HHMMSS.txt** に記録されます。

### ログの見方:

```
2026/02/21 16:08:56 | HRTool起動
2026/02/21 16:09:06 | 選択ファイル数: 4
2026/02/21 16:09:06 | === ReadExcelAllSheets: ファイル読み込み開始 ===
2026/02/21 16:09:07 | ファイル (1/4): 202408.xlsx
2026/02/21 16:09:07 |   シート (1/48): 在職者情報
2026/02/21 16:09:07 |   - シート '在職者情報': Excelが認識=546行 x 38列
2026/02/21 16:09:07 |   → 実データ範囲: 546行 x 38列
...
2026/02/21 16:09:10 | === ReadExcelAllSheets: 完了 (76シート読み込み) ===
2026/02/21 16:09:10 | データ統合中 (52シート)
2026/02/21 16:09:10 | 結合後の行数: 13775行
2026/02/21 16:09:10 | 詳細表生成中
2026/02/21 16:09:11 |   詳細表生成完了: 1234行
2026/02/21 16:09:11 | === 処理完了 ===
```

---

## 対応しているExcel形式

- ✅ .xlsx
- ✅ .xlsm
- ✅ .xls

---

## エラーが発生した場合

### 1. 「inputフォルダが見つかりません」
→ HRTool.exeと同じフォルダに「input」フォルダを作成してください

### 2. 「処理可能なシートがありませんでした」
→ Excelファイルに「社員番号」または「氏名」列が含まれているか確認してください

### 3. exeが起動しない
→ ログファイル（処理ログ_*.txt）を確認してエラー内容をチェックしてください

---

## パフォーマンス

### 実測値（参考）:
- **76シート、約13,000行のデータ**: 数秒〜数十秒で完了
- **VBA版**: 応答なしで処理不可 → **Python版**: 高速処理

---

## 開発者向け情報

### Pythonスクリプトとして実行する場合:

```bash
# 依存パッケージのインストール
pip install -r requirements.txt

# 実行
python HRTool.py
```

### exe化する場合:

詳細は **exe化手順.md** を参照してください。

---

## サポート

問題が発生した場合は、以下の情報を添えて報告してください:
1. ログファイル（処理ログ_*.txt）
2. エラーメッセージのスクリーンショット
3. 使用しているWindowsバージョン

---

## 更新履歴

### v1.0 (2026-02-21)
- 初版リリース
- Excel VBA版の全機能をPythonで再実装
- exe化対応
- パフォーマンス大幅改善
